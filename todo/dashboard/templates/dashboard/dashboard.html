
{% extends "todo/basic.html" %}
{% block body %}
<!-- Create Task Button -->
<div class="mb-5 text-center">
<h1 class="font-extrabold text-white tracking-tight text-center  " style="text-size-adjust: 2rem; size: 5rem;">
  <span class="hidden sm:inline">
    Welcome back, <span class="text-sky-400">{{ user.first_name }}</span> üëã
  </span>
  <span class="inline sm:hidden">
    Welcome back, <span class="text-sky-400">{{ user.first_name }}</span>
  </span>
</h1>

</div>
<div id="text_show" class="p-5 w-full bg-red-500/20 text-white rounded-lg position-sticky top-0 left-0 j-cente ims-center p-4 text-center font-extrabold text-white tracking-tight text-center" style="display: inline-block;">
  <span id="text_show_1">Hey Only Some task remains :</span>
 <span id="totel_comp">{{ totel_complete_task }}</span> <span>/</span> <span id="totel_task">{{ totel_task }}</span>
</div>

<div class="flex justify-end mb-6">
  <button
    id="openTaskModal"
    class="rounded-lg bg-indigo-500 px-4 text-sm font-semibold text-white hover:bg-indigo-400 transition"
  >
    ‚ûï Create Task
  </button>
</div>

<div class="mx-auto mt-10 max-w-5xl grid grid-cols-1 lg:grid-cols-2 gap-8">

  <!-- ‚úÖ COMPLETED TASKS -->
  <div class="rounded-3xl bg-green-900/20 ring-1 ring-green-400/20 p-6">
    <h2 class="text-xl font-semibold text-green-400 mb-4 flex items-center gap-2">
      ‚úÖ Completed Tasks
    </h2>

    <!-- Scrollable area -->
    <div class="max-h-80 overflow-y-auto space-y-3 pr-2">
      {% for task in complete_task %}
        <div class="flex items-center gap-3 bg-green-800/20 p-3 rounded-lg">
          <!-- Number -->
          <span class="text-green-400 font-semibold">
            {{ forloop.counter }}.
          </span>

          <!-- Task name -->
          <span class="flex-1 text-white">
            {{task.title }} ({{task.task_type}})
          </span>

          <!-- Completed icon -->
          <svg class="w-5 h-5 text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                  d="M5 13l4 4L19 7" />
          </svg>
        </div>
      {% empty %}
        <p class="text-gray-400 text-sm">No completed tasks yet.</p>
      {% endfor %}
    </div>
  </div>

  <!-- ‚è≥ PENDING TASKS -->
  <div class="rounded-3xl bg-yellow-900/20 ring-1 ring-yellow-400/20 p-6">
    <h2 class="text-xl font-semibold text-yellow-400 mb-4 flex items-center gap-2">
      ‚è≥ Pending Tasks
    </h2>

    <!-- Scrollable area -->
    <div class="max-h-80 overflow-y-auto space-y-3 pr-2">
      {% for task in pending_task %}
        <div class="flex items-center gap-3 bg-yellow-800/20 p-3 rounded-lg">
          <!-- Number -->
          <span class="text-yellow-400 font-semibold">
            {{ forloop.counter }}.
          </span>

          <!-- Task name -->
          <span class="flex-1 text-white">
            {{task.title }} ({{task.task_type}})
          </span>

          <!-- Mark complete button -->
          <div class="flex items-center gap-2">

  <!-- ‚úÖ COMPLETE -->
  <form method="POST" action="{% url "task:complete" task.id %}">
    {% csrf_token %}
    <button
      type="submit"
      title="Mark as completed"
      class="rounded-full bg-green-500/20 p-2 hover:bg-green-500/40 transition"
    >
      <svg class="w-5 h-5 text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
              d="M5 13l4 4L19 7" />
      </svg>
    </button>
  </form>

  <!-- ‚è∏Ô∏è PAUSE -->
  <form method="POST" action="{% url "task:pause" task.id %}">
    {% csrf_token %}
    <button
      type="submit"
      title="Pause task"
      class="rounded-full bg-yellow-500/20 p-2 hover:bg-yellow-500/40 transition" onclick="return confirm('Are you sure you want to Pause this task?');"      
    >
      <svg class="w-5 h-5 text-yellow-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
              d="M10 5v14M14 5v14" />
      </svg>
    </button>
  </form>

  <!-- üóëÔ∏è DELETE -->
  <form method="POST" action="{% url "task:delete" task.id %}">
    {% csrf_token %}
    <button
      type="submit"
      title="Delete task"
      class="rounded-full bg-red-500/20 p-2 hover:bg-red-500/40 transition"
      onclick="return confirm('Are you sure you want to delete this task?');"
    >
      <svg class="w-5 h-5 text-red-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
              d="M6 18L18 6M6 6l12 12" />
      </svg>
    </button>
  </form>

</div>

              
        </div>
      {% empty %}
        <p class="text-gray-400 text-sm">No pending tasks üéâ</p>
      {% endfor %}
    </div>
  </div>

</div>

<!-- Modal Backdrop -->
<div
  id="taskModal"
  class="fixed inset-0 z-50 hidden items-center justify-center"
>
  <!-- Blur background -->
  <div class="absolute inset-0 bg-black/40 backdrop-blur-sm"></div>

  <!-- Modal Box -->
  <div class="relative z-100 w-full max-w-md rounded-2xl bg-gray-900/50 p-6 ring-1 ring-white/10">
    <h2 class="text-lg font-semibold text-white mb-4">Create New Task</h2>

    <form method="POST" action="{% url 'task:creat-task' %}">
      {% csrf_token %}

      <!-- Title -->
      <div class="mb-3">
        <label class="text-sm text-sky-500/50">Task Title</label>
        <input
          type="text"
          name="title"
          required
          class="mt-1 w-full rounded-md bg-gray-800 border border-sky-500/30 px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-indigo-500"
        />
      </div>

      <!-- Description -->
      <div class="mb-3">
        <label class="text-sm text-sky-500/50">Task Description</label>
        <textarea
          name="description"
          rows="3"
          class="mt-1 w-full rounded-md bg-gray-800 border border-sky-500/30 px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-indigo-500"
        ></textarea>
      </div>

      <!-- Task Type -->
      <div class="mb-3">
        <label class="text-sm text-sky-500/50">Task Type</label>
        <select
          name="task_type"
          class="mt-1 w-full rounded-md bg-gray-800 border border-sky-500/30 px-3 py-2 text-white"
        >
          <option value="Once">Once</option>

          <option value="Daily">Daily</option>
          <option value="Weekly">Weekly</option>
          <option value="Monthly">Monthly</option>
          <option value="Yearly">Yearly</option>
        </select>
      </div>

      <!-- Date -->
      <div class="mb-4">
        <label class="text-sm text-sky-500/50">Select Date</label>
        <input
          type="date"
          name="due_date"
          class="mt-1 w-full rounded-md bg-gray-800 border border-sky-500/30 px-3 py-2 text-white"
        />
      </div>

      <!-- Buttons -->
      <div class="flex justify-end gap-3">
        <button
          type="button"
          id="closeTaskModal"
          class="rounded-md px-4 py-2 text-sm text-gray-300 hover:text-white"
        >
          Cancel
        </button>
        <button
          type="submit"
          class="rounded-md bg-indigo-500 px-4 py-2 text-sm font-semibold text-white hover:bg-indigo-400"
        >
          Create
        </button>
      </div>
    </form>
  </div>
</div>



<script>
  const modal = document.getElementById("taskModal");
  const openBtn = document.getElementById("openTaskModal");
  const closeBtn = document.getElementById("closeTaskModal");

  const text = document.getElementById("text_show");
  const totel_comp = document.getElementById("totel_comp");
  const totel_task=document.getElementById("totel_task");
  if  (totel_comp.innerText==totel_task.innerText){
    text.classList.remove("bg-red-500/20");
    text.classList.add("bg-green-500/20");
    text.innerText="Great job! All task has completed ! ";
  }
  else{
    text.classList.remove("bg-red-500/10");
    text.classList.add("bg-green-500/10");
  }


  openBtn.addEventListener("click", () => {
    modal.classList.remove("hidden");
    modal.classList.add("flex");
    document.body.classList.add("overflow-hidden");
  });

  closeBtn.addEventListener("click", () => {
    modal.classList.add("hidden");
    modal.classList.remove("flex");
    document.body.classList.remove("overflow-hidden");
  });
</script>


{% endblock %}
